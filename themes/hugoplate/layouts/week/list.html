{{ define "main" }}
  <!-- Banner -->
  {{ with .Params.banner }}
    <section class="relative pt-20 pb-16 overflow-hidden">
      <!-- Background gradient moderne -->
      <div class="absolute inset-0" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 50%, #136b62 100%);"></div>
      <!-- Overlay pour plus de profondeur -->
      <div class="absolute inset-0" style="background: linear-gradient(90deg, transparent 0%, rgba(33, 160, 149, 0.2) 50%, transparent 100%);"></div>
      
      <!-- Decorative elements élégants -->
      <div class="absolute inset-0">
        <div class="absolute top-10 left-10 w-20 h-20 opacity-30 rounded-full blur-xl animate-pulse" style="background: rgba(33, 160, 149, 0.4);"></div>
        <div class="absolute top-40 right-20 w-32 h-32 opacity-20 rounded-full blur-2xl animate-bounce" style="background: rgba(33, 160, 149, 0.3);"></div>
        <div class="absolute bottom-20 left-1/4 w-24 h-24 opacity-25 rounded-full blur-xl animate-pulse delay-1000" style="background: rgba(33, 160, 149, 0.35);"></div>
        <div class="absolute bottom-10 right-10 w-16 h-16 opacity-30 rounded-full blur-lg animate-bounce delay-500" style="background: rgba(33, 160, 149, 0.4);"></div>
        <!-- Formes géométriques modernes -->
        <div class="absolute top-1/3 left-1/2 transform -translate-x-1/2 w-40 h-40 rounded-3xl rotate-45 blur-xl" style="background: rgba(33, 160, 149, 0.15);"></div>
      </div>

      <div class="container relative z-10">
        <div class="row justify-center">
          <div class="lg:col-10 text-center text-white">
            <!-- Icon principale moderne -->
            <div class="inline-flex items-center justify-center w-28 h-28 rounded-3xl mb-8 shadow-2xl transform hover:scale-110 transition-all duration-300 rotate-12 hover:rotate-0" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);">
              <i class="fa fa-mountain text-5xl text-white drop-shadow-lg"></i>
            </div>
            
            <h1 class="mb-6 text-4xl lg:text-6xl font-bold leading-tight">
              {{ .title | markdownify }}
            </h1>
            <p class="mb-8 text-xl lg:text-2xl font-light opacity-90 max-w-3xl mx-auto">
              {{ .content | markdownify }}
            </p>
            
            <!-- Badges informatifs modernes -->
            <div class="flex flex-wrap justify-center gap-4 mb-8">
              <span class="inline-flex items-center px-6 py-3 rounded-2xl text-white shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);">
                <i class="fa fa-calendar mr-3 text-lg"></i>
                <strong>20-21 Septembre 2025</strong>
              </span>
              <span class="inline-flex items-center px-6 py-3 rounded-2xl text-white shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);">
                <i class="fa fa-map-marker mr-3 text-lg"></i>
                <strong>Salavas (07)</strong>
              </span>
              <span class="inline-flex items-center px-6 py-3 rounded-2xl text-white shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);">
                <i class="fa fa-users mr-3 text-lg"></i>
                <strong>Tous niveaux</strong>
              </span>
            </div>
            
            <div class="flex flex-wrap justify-center gap-4">
              {{ with .button }}
                {{ if .enable }}
                  <a
                    class="btn text-white shadow-2xl transform hover:scale-110 transition-all duration-300 text-xl px-8 py-4 rounded-2xl font-bold border-none"
                    style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%); &:hover { background: linear-gradient(135deg, #1a8a7f 0%, #136b62 100%); }"
                    href="{{ if strings.HasPrefix .link "#" }}{{ .link }}{{ else }}{{ .link | absURL }}{{ end }}"
                    {{ if strings.HasPrefix .link `http` }}
                      target="_blank" rel="noopener"
                    {{ end }}>
                    {{ .label }}
                    <i class="fa fa-rocket pl-3"></i>
                  </a>
                {{ end }}
              {{ end }}
              {{ with .secondary_button }}
                {{ if .enable }}
                  <a
                    class="btn bg-transparent border-3 border-white text-white hover:bg-white transition-all duration-300 text-xl px-8 py-4 rounded-2xl font-bold backdrop-blur-sm"
                    style="&:hover { color: #21A095; }"
                    href="{{ if strings.HasPrefix .link "#" }}{{ .link }}{{ else }}{{ .link | absURL }}{{ end }}">
                    {{ .label }}
                    <i class="fa fa-play-circle pl-3"></i>
                  </a>
                {{ end }}
              {{ end }}
            </div>
          </div>
        </div>
      </div>
    </section>
  {{ end }}
  <!-- /Banner -->

  <!-- Weekend Info -->
  {{ with .Params.weekend_info }}
    {{ if .enable }}
      <section class="section-sm dark:from-darkmode-light dark:to-darkmode-light" style="background: linear-gradient(90deg, rgba(33, 160, 149, 0.05) 0%, rgba(33, 160, 149, 0.1) 50%, rgba(33, 160, 149, 0.05) 100%);">
        <div class="container">
          <div class="row">
            <div class="col-12 text-center mb-12">
              <h2 class="mb-6 text-4xl font-bold" style="color: #21A095;">{{ .title }}</h2>
              <div class="w-32 h-1.5 mx-auto rounded-full" style="background: #21A095;"></div>
            </div>
          </div>
          <div class="row justify-center">
            {{ range .items }}
              <div class="lg:col-3 md:col-6 mb-6">
                <div class="bg-gradient-to-br from-white to-gray-50 dark:bg-darkmode-dark rounded-3xl p-8 text-center shadow-2xl hover:shadow-3xl transform hover:-translate-y-3 hover:rotate-1 transition-all duration-500 h-full border-2 border-transparent bg-clip-padding relative overflow-hidden group">
                  <!-- Bordure animée -->
                  <div class="absolute inset-0 rounded-3xl opacity-0 group-hover:opacity-100 transition-all duration-500 -z-10" style="background: #21A095;"></div>
                  <div class="absolute inset-0.5 bg-gradient-to-br from-white to-gray-50 dark:bg-darkmode-dark rounded-3xl"></div>
                  <!-- Contenu -->
                  <div class="relative z-10">
                    <div class="text-6xl mb-6 filter drop-shadow-xl transform group-hover:scale-110 transition-transform duration-300">{{ .icon }}</div>
                    <h3 class="text-xl mb-4 font-bold bg-gradient-to-r from-gray-800 to-gray-600 dark:from-white dark:to-gray-200 bg-clip-text text-transparent">{{ .title }}</h3>
                    <p class="text-lg text-gray-600 dark:text-gray-300 leading-relaxed">{{ .content | markdownify }}</p>
                  </div>
                </div>
              </div>
            {{ end }}
          </div>
        </div>
      </section>
    {{ end }}
  {{ end }}
  <!-- /Weekend Info -->

  <!-- Features -->
  <section class="section">
    <div class="container">
      <div class="row">
        <div class="col-12 text-center mb-16">
          <h2 class="text-5xl font-bold mb-6" style="color: #21A095;">Pourquoi choisir ce week-end ?</h2>
          <p class="text-2xl font-light text-gray-700 dark:text-gray-300 max-w-3xl mx-auto leading-relaxed">Une expérience unique alliant sport, nature et convivialité dans un cadre d'exception</p>
          <div class="w-32 h-1.5 mx-auto rounded-full mt-8" style="background: #21A095;"></div>
        </div>
      </div>
      <div class="row">
        {{ range $i, $e:= .Params.features }}
          <div class="lg:col-4 md:col-6 mb-8">
            <div class="relative bg-white dark:bg-darkmode-dark rounded-3xl p-8 shadow-xl hover:shadow-2xl transform hover:-translate-y-3 transition-all duration-500 h-full group border border-gray-100">
              <!-- Icône selon le titre -->
              <div class="absolute -top-8 left-8">
                <div class="w-16 h-16 rounded-3xl flex items-center justify-center shadow-2xl group-hover:scale-125 group-hover:rotate-12 transition-all duration-500" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);">
                  {{ if eq .title "VTT en montagne" }}
                    <i class="fa fa-mountain text-white text-2xl"></i>
                  {{ else if eq .title "Activités adaptées" }}
                    <i class="fa fa-cogs text-white text-2xl"></i>
                  {{ else }}
                    <i class="fa fa-heart text-white text-2xl"></i>
                  {{ end }}
                </div>
              </div>
              
              <div class="pt-8">
                <h3 class="text-2xl font-bold mb-4 text-gray-800 dark:text-white transition-colors duration-300" style="&:hover { color: #21A095; }">
                  {{ .title | markdownify }}
                </h3>
                <p class="text-gray-600 dark:text-gray-300 mb-6 leading-relaxed">
                  {{ .content | markdownify }}
                </p>
                
                <!-- Liste des points -->
                <div class="space-y-3">
                  {{ range .bulletpoints }}
                    <div class="flex items-start">
                      <div class="w-6 h-6 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mr-3 mt-0.5 flex-shrink-0">
                        <i class="fa fa-check text-green-600 dark:text-green-400 text-sm"></i>
                      </div>
                      <p class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">{{ . | markdownify }}</p>
                    </div>
                  {{ end }}
                </div>
              </div>
              
              <!-- Effet de décoration -->
              <div class="absolute bottom-0 right-0 w-24 h-24 bg-gradient-to-br from-primary/5 to-secondary/5 rounded-tl-3xl rounded-br-3xl"></div>
            </div>
          </div>
        {{ end }}
      </div>
    </div>
  </section>
  <!-- /Features -->

  <!-- Programme -->
  {{ with .Params.programme }}
    {{ if .enable }}
      <section class="section dark:from-darkmode-light dark:to-darkmode-dark" id="programme" style="background: linear-gradient(135deg, rgba(33, 160, 149, 0.03) 0%, rgba(33, 160, 149, 0.08) 50%, rgba(33, 160, 149, 0.03) 100%);">
        <div class="container">
          <div class="row">
            <div class="col-12 text-center mb-16">
              <h2 class="text-5xl font-bold mb-6" style="color: #21A095;">{{ .title }}</h2>
              <p class="text-2xl font-light text-gray-700 dark:text-gray-300 leading-relaxed">Découvrez le déroulement détaillé de votre week-end d'aventure</p>
              <div class="w-32 h-1.5 mx-auto rounded-full mt-8" style="background: #21A095;"></div>
            </div>
          </div>
          <div class="row justify-center">
            {{ range $dayIndex, $day := .days }}
              <div class="lg:col-6 mb-12">
                <div class="relative">
                  <!-- Header du jour -->
                  <div class="text-white rounded-t-3xl p-8 text-center relative overflow-hidden" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);">
                    <div class="absolute inset-0 bg-white/10 backdrop-blur-sm"></div>
                    <div class="relative z-10">
                      <div class="inline-flex items-center justify-center w-16 h-16 bg-white/20 rounded-full mb-4 border-2 border-white/30">
                        <span class="text-2xl font-bold">{{ add $dayIndex 1 }}</span>
                      </div>
                      <h3 class="text-3xl font-bold mb-2">{{ .day }}</h3>
                      <p class="text-xl opacity-90">{{ .date }}</p>
                    </div>
                    <!-- Éléments décoratifs -->
                    <div class="absolute -top-4 -right-4 w-24 h-24 bg-white/5 rounded-full"></div>
                    <div class="absolute -bottom-2 -left-2 w-16 h-16 bg-white/10 rounded-full"></div>
                  </div>
                  
                  <!-- Corps du programme -->
                  <div class="bg-white dark:bg-darkmode-dark rounded-b-3xl shadow-2xl p-8 border-l-4 border-r-4 border-b-4 border-gray-100">
                    <div class="space-y-6">
                      {{ range $index, $item := .schedule }}
                        <div class="relative flex items-start group">
                          <!-- Timeline vertical -->
                          {{ if not (eq $index (sub (len $day.schedule) 1)) }}
                            <div class="absolute left-6 top-16 w-0.5 h-16 bg-gradient-to-b from-primary to-primary/30"></div>
                          {{ end }}
                          
                          <!-- Heure -->
                          <div class="relative">
                            <div class="w-12 h-12 bg-gradient-to-r from-primary to-secondary rounded-2xl flex items-center justify-center text-white font-bold text-sm shadow-lg group-hover:scale-110 transition-transform duration-300">
                              <i class="fa fa-clock"></i>
                            </div>
                            <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-primary text-white px-3 py-1 rounded-full text-xs font-bold whitespace-nowrap">
                              {{ .time }}
                            </div>
                          </div>
                          
                          <!-- Contenu -->
                          <div class="ml-6 flex-1 pt-1">
                            <div class="bg-gray-50 dark:bg-darkmode-light rounded-2xl p-6 group-hover:bg-primary/5 transition-colors duration-300">
                              <h4 class="text-xl font-bold mb-3 text-gray-800 dark:text-white group-hover:text-primary transition-colors duration-300">
                                {{ .activity }}
                              </h4>
                              <p class="text-gray-600 dark:text-gray-300 leading-relaxed">
                                {{ .description }}
                              </p>
                            </div>
                          </div>
                        </div>
                      {{ end }}
                    </div>
                  </div>
                </div>
              </div>
            {{ end }}
          </div>
        </div>
      </section>
    {{ end }}
  {{ end }}
  <!-- /Programme -->

  <!-- Practical Info -->
  {{ with .Params.practical_info }}
    {{ if .enable }}
      <section class="section bg-white dark:bg-darkmode-dark">
        <div class="container">
          <div class="row">
            <div class="col-12 text-center mb-16">
              <h2 class="text-4xl font-bold mb-4">{{ .title }}</h2>
              <p class="text-xl text-gray-600 dark:text-gray-300">Tout ce que vous devez savoir pour bien préparer votre week-end</p>
              <div class="w-24 h-1 bg-primary mx-auto rounded-full mt-6"></div>
            </div>
          </div>
          <div class="row justify-center">
            <div class="lg:col-12">
              <div class="grid md:grid-cols-2 gap-8">
                {{ range $index, $section := .sections }}
                  <div class="group">
                    <div class="bg-gradient-to-br from-gray-50 to-blue-50 dark:from-darkmode-light dark:to-darkmode-light rounded-3xl p-8 shadow-xl hover:shadow-2xl transform hover:-translate-y-2 transition-all duration-500 h-full border border-gray-100 relative overflow-hidden">
                      <!-- Icône de fond décorative -->
                      <div class="absolute -top-4 -right-4 w-32 h-32 opacity-5">
                        {{ if eq $index 0 }}
                          <i class="fa fa-bicycle text-8xl text-primary"></i>
                        {{ else if eq $index 1 }}
                          <i class="fa fa-campground text-8xl text-primary"></i>
                        {{ else if eq $index 2 }}
                          <i class="fa fa-user-graduate text-8xl text-primary"></i>
                        {{ else }}
                          <i class="fa fa-cog text-8xl text-primary"></i>
                        {{ end }}
                      </div>
                      
                      <div class="relative z-10">
                        <h3 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white group-hover:text-primary transition-colors duration-300">
                          {{ .title }}
                        </h3>
                        <div class="prose prose-lg dark:prose-invert max-w-none">
                          <p class="text-gray-600 dark:text-gray-300 leading-relaxed">
                            {{ .content | markdownify }}
                          </p>
                        </div>
                      </div>
                      
                      <!-- Élément décoratif en bas -->
                      <div class="absolute bottom-0 left-0 w-full h-2 bg-gradient-to-r from-primary/20 to-secondary/20"></div>
                    </div>
                  </div>
                {{ end }}
              </div>
            </div>
          </div>
        </div>
      </section>
    {{ end }}
  {{ end }}
  <!-- /Practical Info -->

  <!-- Formulaire d'inscription -->
  {{ with .Params.inscription_form }}
    {{ if .enable }}
      <section class="section dark:from-darkmode-light dark:to-darkmode-light" id="inscription" style="background: linear-gradient(135deg, rgba(33, 160, 149, 0.05) 0%, rgba(33, 160, 149, 0.1) 50%, rgba(33, 160, 149, 0.05) 100%);">
        <div class="container">
          <div class="row justify-center">
            <div class="lg:col-8">
              <!-- Header du formulaire -->
              <div class="text-center mb-12">
                <div class="inline-flex items-center justify-center w-24 h-24 rounded-3xl mb-8 shadow-2xl transform hover:scale-110 transition-all duration-300" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);">
                  <i class="fa fa-user-plus text-white text-3xl"></i>
                </div>
                <h2 class="text-5xl font-bold mb-6" style="color: #21A095;">{{ .title }}</h2>
                <p class="text-2xl font-light text-gray-700 dark:text-gray-300">{{ .subtitle }}</p>
                <div class="w-32 h-1.5 mx-auto rounded-full mt-8" style="background: #21A095;"></div>
              </div>

              <!-- Formulaire -->
              <div class="bg-white dark:bg-darkmode-dark rounded-3xl shadow-2xl p-8 lg:p-12 border border-gray-100">
                <form id="inscription-form" class="space-y-6">
                  <div class="grid md:grid-cols-2 gap-6">
                    {{ range .fields }}
                      <div class="{{ if eq .name "email" }}md:col-span-2{{ end }}{{ if eq .name "nombre_personnes" }}md:col-span-2{{ end }}">
                        {{ if eq .name "nombre_personnes" }}
                          <!-- Encadré explicatif pour le nombre de personnes -->
                          <div class="bg-amber-50 border border-amber-200 rounded-xl p-4 mb-4">
                            <div class="flex items-start">
                              <i class="fas fa-lightbulb text-amber-500 text-lg mt-1 mr-3"></i>
                              <div class="text-amber-800">
                                <p class="font-semibold mb-1">Comment compter le nombre de participants ?</p>
                                <ul class="text-sm space-y-1">
                                  <li>• <strong>Vous seul :</strong> indiquez 1</li>
                                  <li>• <strong>Vous + votre conjoint :</strong> indiquez 2</li>
                                  <li>• <strong>Vous + 2 enfants :</strong> indiquez 3</li>
                                  <li>• <strong>Famille de 4 personnes :</strong> indiquez 4</li>
                                </ul>
                              </div>
                            </div>
                          </div>
                        {{ end }}
                        <label for="{{ .name }}" class="block text-sm font-bold text-gray-700 dark:text-gray-300 mb-3">
                          {{ .label }}{{ if .required }}<span class="text-red-500 ml-1">*</span>{{ end }}
                        </label>
                        <div class="relative">
                          <input
                            type="{{ .type }}"
                            id="{{ .name }}"
                            name="{{ .name }}"
                            {{ if .required }}required{{ end }}
                            {{ if .min }}min="{{ .min }}"{{ end }}
                            {{ if .max }}max="{{ .max }}"{{ end }}
                            placeholder="{{ .placeholder }}"
                            class="w-full px-4 py-4 border border-gray-300 dark:border-darkmode-border rounded-2xl focus:ring-2 focus:border-transparent dark:bg-darkmode-light dark:text-white text-lg transition-all duration-300"
                            style="&:focus { ring-color: #21A095; } &:hover { border-color: rgba(33, 160, 149, 0.5); }"
                            {{ if eq .name "nombre_personnes" }}
                              onchange="handleNombrePersonnesChange()"
                              onkeyup="handleNombrePersonnesChange()"
                            {{ end }}
                          >
                          {{ if eq .name "telephone" }}
                            <i class="fa fa-phone absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                          {{ else if eq .name "email" }}
                            <i class="fa fa-envelope absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                          {{ else if eq .name "nombre_personnes" }}
                            <i class="fa fa-users absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                          {{ end }}
                        </div>
                      </div>
                    {{ end }}
                  </div>

                  <!-- Section dynamique pour les participants -->
                  <div id="participants-section" class="hidden">
                    <div class="border-t border-gray-200 pt-8 mt-6">
                      <h3 class="text-2xl font-bold text-gray-800 dark:text-white mb-6 flex items-center">
                        <i class="fa fa-users text-2xl mr-3" style="color: #21A095;"></i>
                        Informations des participants
                      </h3>
                      <div class="bg-blue-50 border-l-4 border-blue-400 p-6 mb-8 rounded-r-lg">
                        <div class="flex">
                          <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400 text-xl"></i>
                          </div>
                          <div class="ml-3">
                            <h4 class="text-lg font-medium text-blue-800 mb-2">Important !</h4>
                            <div class="text-blue-700 space-y-2">
                              <p><strong>Vous devez vous renseigner vous-même comme participant n°1</strong></p>
                              <p>Remplissez ensuite les informations des autres participants (famille, amis, etc.)</p>
                              <p>Tous les participants doivent avoir <strong>7 ans ou plus</strong> le jour du week-end.</p>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <div id="participants-container" class="space-y-6">
                        <!-- Les champs pour chaque participant seront générés dynamiquement ici -->
                      </div>
                    </div>
                  </div>

                  <!-- Calcul du prix -->
                  <div class="rounded-2xl p-6 mt-8" style="background: rgba(33, 160, 149, 0.1);">
                    <div class="flex items-center justify-between">
                      <div>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-white">Prix total</h3>
                        <p class="text-gray-600 dark:text-gray-300">{{ .price_per_person }}€ par personne</p>
                      </div>
                      <div class="text-right">
                        <div id="price-calculation" class="text-3xl font-bold" style="color: #21A095;">{{ .price_per_person }}€</div>
                        <div id="person-count" class="text-sm text-gray-600 dark:text-gray-300">1 personne</div>
                      </div>
                    </div>
                  </div>

                  <!-- Bouton de soumission -->
                  <div class="text-center pt-6">
                    <button
                      type="submit"
                      id="submit-button"
                      class="text-white px-12 py-5 rounded-3xl text-xl font-bold shadow-2xl hover:shadow-3xl transform hover:scale-110 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none hover:opacity-90"
                      style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);"
                    >
                      <span id="button-text">{{ .submit_button.label }}</span>
                      <i class="fa fa-arrow-right ml-3"></i>
                    </button>
                    <p class="text-sm text-gray-600 dark:text-gray-300 mt-4">
                      En soumettant ce formulaire, vous confirmez votre inscription au week-end VTT.
                    </p>
                  </div>

                  <!-- Message de succès/erreur (caché par défaut) -->
                  <div id="form-message" class="hidden mt-6 p-4 rounded-2xl text-center font-medium"></div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </section>
    {{ end }}
  {{ end }}
  <!-- /Formulaire d'inscription -->

  <!-- Content -->
  {{ if .Content }}
    <section class="section bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-darkmode-light dark:to-darkmode-light">
      <div class="container">
        <div class="row justify-center">
          <div class="lg:col-10">
            <div class="bg-white dark:bg-darkmode-dark rounded-3xl p-12 shadow-2xl border border-gray-100">
              <div class="prose prose-xl dark:prose-invert max-w-none text-center">
                {{ .Content }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  {{ end }}
  <!-- /Content -->

  <!-- Call to Action -->
  {{ with .Params.call_to_action }}
    {{ if .enable }}
      <section class="section relative overflow-hidden">
        <!-- Background gradient animé -->
        <div class="absolute inset-0" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 50%, #136b62 100%);"></div>
        <div class="absolute inset-0 animate-pulse" style="background: linear-gradient(90deg, rgba(33, 160, 149, 0.3) 0%, transparent 50%, rgba(33, 160, 149, 0.3) 100%);"></div>
        
        <!-- Éléments décoratifs -->
        <div class="absolute inset-0">
          <div class="absolute top-20 left-20 w-32 h-32 bg-white/10 rounded-full blur-2xl animate-pulse"></div>
          <div class="absolute top-40 right-32 w-24 h-24 bg-white/15 rounded-full blur-xl animate-bounce delay-1000"></div>
          <div class="absolute bottom-32 left-1/3 w-28 h-28 bg-white/5 rounded-full blur-2xl animate-pulse delay-500"></div>
          <div class="absolute bottom-20 right-20 w-20 h-20 bg-white/20 rounded-full blur-lg animate-bounce delay-2000"></div>
        </div>

        <div class="container relative z-10">
          <div class="row justify-center">
            <div class="lg:col-10 text-center text-white">
              <!-- Icône centrale -->
              <div class="inline-flex items-center justify-center w-36 h-36 rounded-full mb-8 shadow-2xl border-4 border-white/50 animate-bounce hover:animate-spin" style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);">
                <i class="fa fa-trophy text-6xl text-white drop-shadow-xl"></i>
              </div>
              
              <h2 class="mb-6 text-4xl lg:text-5xl font-bold leading-tight">
                {{ .title | markdownify }}
              </h2>
              <p class="mb-12 text-2xl font-light opacity-90 max-w-4xl mx-auto leading-relaxed">
                {{ .content | markdownify }}
              </p>
              
              <!-- Compteur d'urgence -->
              <div class="bg-white/20 rounded-2xl p-6 mb-8 backdrop-blur-sm border border-white/30 max-w-md mx-auto">
                <p class="text-lg font-semibold mb-2">⏰ Date limite d'inscription</p>
                <p class="text-3xl font-bold">19 Septembre 2025</p>
              </div>
              
              <div class="flex flex-wrap justify-center gap-6">
                {{ with .button }}
                  {{ if .enable }}
                    <a
                      class="btn text-white shadow-2xl transform hover:scale-110 transition-all duration-300 text-xl px-10 py-5 rounded-2xl font-bold border-none hover:opacity-90"
                      style="background: linear-gradient(135deg, #21A095 0%, #1a8a7f 100%);"
                      href="{{ if strings.HasPrefix .link "#" }}{{ .link }}{{ else }}{{ .link | absURL }}{{ end }}"
                      {{ if strings.HasPrefix .link `http` }}
                        target="_blank" rel="noopener"
                      {{ end }}>
                      {{ .label }}
                      <i class="fa fa-rocket pl-3"></i>
                    </a>
                  {{ end }}
                {{ end }}
                {{ with .secondary_button }}
                  {{ if .enable }}
                    <a
                      class="btn border-3 border-white text-white hover:bg-white hover:text-primary transition-all duration-300 text-xl px-8 py-4 rounded-2xl font-bold backdrop-blur-sm"
                      href="{{ if strings.HasPrefix .link "#" }}{{ .link }}{{ else }}{{ .link | absURL }}{{ end }}">
                      {{ .label }}
                      <i class="fa fa-eye pl-3"></i>
                    </a>
                  {{ end }}
                {{ end }}
              </div>
              
              <!-- Message de confiance -->
              <div class="mt-12 flex flex-wrap justify-center items-center gap-8 text-white/80">
                <div class="flex items-center">
                  <i class="fa fa-shield-alt text-2xl mr-3"></i>
                  <span class="text-lg">Encadrement professionnel</span>
                </div>
                <div class="flex items-center">
                  <i class="fa fa-users text-2xl mr-3"></i>
                  <span class="text-lg">Groupe convivial</span>
                </div>
                <div class="flex items-center">
                  <i class="fa fa-heart text-2xl mr-3"></i>
                  <span class="text-lg">Expérience inoubliable</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    {{ end }}
  {{ end }}
  <!-- /Call to Action -->

  <!-- JavaScript pour le formulaire -->
  {{ with .Params.inscription_form }}
    {{ if .enable }}
      <!-- Supabase SDK -->
      <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
      <script>
        // Configuration Supabase
        const supabaseUrl = 'https://jiforbxelcpihbphrtzx.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImppZm9yYnhlbGNwaWhicGhydHp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM2MzczMjEsImV4cCI6MjA2OTIxMzMyMX0.L1RMxREEi9txY-n31Bbrl4A9nWm2E_47WzaYdbrwVt8';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
        
        // Variables globales
        const pricePerPerson = {{ .price_per_person }};
        const webhookUrl = 'https://automate.naturavelo.net/webhook/inscri-week-evtt';
        
        // Fonction pour envoyer les données au webhook
        async function sendToWebhook(inscriptionData, participantsData, inscriptionId) {
          try {
            // Préparer les paramètres pour l'URL
            const params = new URLSearchParams();
            
            // Données principales de l'inscription
            params.append('inscription_id', inscriptionId);
            params.append('nom', inscriptionData.nom);
            params.append('prenom', inscriptionData.prenom);
            params.append('email', inscriptionData.email);
            params.append('telephone', inscriptionData.telephone);
            params.append('nombre_personnes', inscriptionData.nombre_personnes);
            params.append('prix_total', inscriptionData.prix_total);
            params.append('evenement', inscriptionData.evenement);
            params.append('date_inscription', inscriptionData.date_inscription);
            params.append('statut', inscriptionData.statut);
            
            // Ajouter les participants (format JSON stringifié)
            params.append('participants', JSON.stringify(participantsData));
            
            // Construire l'URL complète
            const fullUrl = `${webhookUrl}?${params.toString()}`;
            
            // Envoyer la requête GET
            const response = await fetch(fullUrl, {
              method: 'GET',
              headers: {
                'Content-Type': 'application/json',
              }
            });
            
            if (!response.ok) {
              console.warn('Webhook response not OK:', response.status, response.statusText);
            } else {
              console.log('Webhook envoyé avec succès');
            }
            
          } catch (error) {
            // Ne pas faire échouer l'inscription si le webhook échoue
            console.warn('Erreur lors de l\'envoi vers le webhook (non-bloquant):', error);
          }
        }
        
        // Scroll fluide pour les liens d'ancrage
        document.addEventListener('DOMContentLoaded', function() {
          // Gérer tous les liens qui pointent vers des ancres
          document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
              e.preventDefault();
              const target = document.querySelector(this.getAttribute('href'));
              if (target) {
                target.scrollIntoView({
                  behavior: 'smooth',
                  block: 'start'
                });
              }
            });
          });
        });
        
        // Fonction de validation des données des participants
        function validateParticipantsData(nombrePersonnes) {
          if (nombrePersonnes <= 0) {
            return 'Veuillez indiquer un nombre de personnes valide.';
          }
          
          for (let i = 1; i <= nombrePersonnes; i++) {
            const nom = document.getElementById(`participant_${i}_nom`);
            const prenom = document.getElementById(`participant_${i}_prenom`);
            const dateNaissance = document.getElementById(`participant_${i}_date_naissance`);
            
            const participantLabel = i === 1 ? 'votre nom (participant 1)' : `le nom du participant ${i}`;
            const prenomLabel = i === 1 ? 'votre prénom (participant 1)' : `le prénom du participant ${i}`;
            const dateLabel = i === 1 ? 'votre date de naissance (participant 1)' : `la date de naissance du participant ${i}`;
            
            if (!nom || !nom.value.trim()) {
              return `Veuillez renseigner ${participantLabel}.`;
            }
            
            if (!prenom || !prenom.value.trim()) {
              return `Veuillez renseigner ${prenomLabel}.`;
            }
            
            if (!dateNaissance || !dateNaissance.value) {
              return `Veuillez renseigner ${dateLabel}.`;
            }
            
            // Vérifier que la personne a au moins 7 ans
            const birthDate = new Date(dateNaissance.value);
            const today = new Date();
            const age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
              age--;
            }
            
            if (age < 7) {
              const personLabel = i === 1 ? 'Vous' : `Le participant ${i}`;
              return `${personLabel} (${prenom.value} ${nom.value}) devez avoir au moins 7 ans pour participer au week-end.`;
            }
          }
          
          return null; // Aucune erreur
        }

        // Fonction pour gérer le changement du nombre de personnes
        function handleNombrePersonnesChange() {
          calculateTotal();
          generateParticipantsFields();
        }

        // Fonction de calcul du prix total
        function calculateTotal() {
          const nombrePersonnes = parseInt(document.getElementById('nombre_personnes').value) || 1;
          const total = nombrePersonnes * pricePerPerson;
          
          // Mise à jour de l'affichage
          document.getElementById('price-calculation').textContent = total + '€';
          document.getElementById('person-count').textContent = nombrePersonnes + (nombrePersonnes > 1 ? ' personnes' : ' personne');
        }

        // Fonction pour générer les champs des participants
        function generateParticipantsFields() {
          const nombrePersonnes = parseInt(document.getElementById('nombre_personnes').value) || 0;
          const participantsSection = document.getElementById('participants-section');
          const participantsContainer = document.getElementById('participants-container');
          
          if (nombrePersonnes <= 0) {
            participantsSection.classList.add('hidden');
            return;
          }
          
          // Afficher la section
          participantsSection.classList.remove('hidden');
          
          // Vider le conteneur existant
          participantsContainer.innerHTML = '';
          
          // Générer les champs pour chaque participant
          for (let i = 1; i <= nombrePersonnes; i++) {
            const participantDiv = document.createElement('div');
            const isFirstParticipant = i === 1;
            participantDiv.className = isFirstParticipant 
              ? 'bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-2xl border-2 border-green-200' 
              : 'bg-gradient-to-br from-gray-50 to-blue-50 p-6 rounded-2xl border border-blue-100';
            
            const participantTitle = isFirstParticipant 
              ? 'Vous (responsable de l\'inscription)'
              : `Participant ${i}`;
              
            const participantColor = isFirstParticipant 
              ? 'from-green-500 to-emerald-500'
              : 'from-blue-500 to-indigo-500';
            
            participantDiv.innerHTML = `
              <div class="mb-4">
                <h4 class="text-lg font-bold text-gray-800 flex items-center">
                  <span class="w-8 h-8 bg-gradient-to-r ${participantColor} text-white rounded-full flex items-center justify-center text-sm font-bold mr-3">${i}</span>
                  ${participantTitle}
                  ${isFirstParticipant ? '<span class="ml-2 text-sm bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium">Obligatoire</span>' : ''}
                </h4>
              </div>
              
              <div class="grid md:grid-cols-3 gap-4">
                <div>
                  <label for="participant_${i}_nom" class="block text-sm font-bold text-gray-700 mb-2">
                    Nom <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="participant_${i}_nom"
                    name="participant_${i}_nom"
                    required
                    placeholder="Nom de famille"
                    class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base transition-all duration-300"
                  >
                </div>
                
                <div>
                  <label for="participant_${i}_prenom" class="block text-sm font-bold text-gray-700 mb-2">
                    Prénom <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="participant_${i}_prenom"
                    name="participant_${i}_prenom"
                    required
                    placeholder="Prénom"
                    class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base transition-all duration-300"
                  >
                </div>
                
                <div>
                  <label for="participant_${i}_date_naissance" class="block text-sm font-bold text-gray-700 mb-2">
                    Date de naissance <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="date"
                    id="participant_${i}_date_naissance"
                    name="participant_${i}_date_naissance"
                    required
                    max="${new Date().toISOString().split('T')[0]}"
                    class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base transition-all duration-300"
                  >
                </div>
              </div>
            `;
            
            participantsContainer.appendChild(participantDiv);
          }
        }
        
        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
          // Calcul initial
          calculateTotal();
          
          // Gestion du formulaire
          const form = document.getElementById('inscription-form');
          const submitButton = document.getElementById('submit-button');
          const buttonText = document.getElementById('button-text');
          const formMessage = document.getElementById('form-message');
          
          form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Désactiver le bouton pendant l'envoi
            submitButton.disabled = true;
            buttonText.textContent = '{{ .submit_button.processing_label }}';
            
            // Valider que tous les champs participants sont remplis
            const nombrePersonnes = parseInt(document.getElementById('nombre_personnes').value);
            const validationError = validateParticipantsData(nombrePersonnes);
            if (validationError) {
              throw new Error(validationError);
            }
            
            // Récupérer les données du formulaire principal
            const formData = new FormData(form);
            const inscriptionData = {
              nom: formData.get('nom'),
              prenom: formData.get('prenom'),
              email: formData.get('email'),
              telephone: formData.get('telephone'),
              nombre_personnes: nombrePersonnes,
              prix_total: nombrePersonnes * pricePerPerson,
              evenement: 'Week-end VTT - 20-21 septembre 2025',
              date_inscription: new Date().toISOString(),
              statut: 'en_attente'
            };
            
            // Collecter les données des participants
            const participantsData = [];
            for (let i = 1; i <= nombrePersonnes; i++) {
              const nom = document.getElementById(`participant_${i}_nom`).value;
              const prenom = document.getElementById(`participant_${i}_prenom`).value;
              const dateNaissance = document.getElementById(`participant_${i}_date_naissance`).value;
              
              participantsData.push({
                nom: nom,
                prenom: prenom,
                date_naissance: dateNaissance,
                ordre_participant: i
              });
            }
            
            try {
              // Étape 1: Insérer l'inscription principale
              const { data: inscriptionResult, error: inscriptionError } = await supabase
                .from('inscriptions_weekend_vtt')
                .insert([inscriptionData])
                .select();
              
              if (inscriptionError) {
                throw inscriptionError;
              }
              
              const inscriptionId = inscriptionResult[0].id;
              
              // Étape 2: Insérer les participants en lot
              const participantsWithInscriptionId = participantsData.map(participant => ({
                ...participant,
                inscription_id: inscriptionId
              }));
              
              const { error: participantsError } = await supabase
                .from('participants_weekend_vtt')
                .insert(participantsWithInscriptionId);
              
              if (participantsError) {
                // Si l'insertion des participants échoue, supprimer l'inscription
                await supabase
                  .from('inscriptions_weekend_vtt')
                  .delete()
                  .eq('id', inscriptionId);
                throw participantsError;
              }
              
              // Envoyer les données au webhook (non-bloquant)
              await sendToWebhook(inscriptionData, participantsData, inscriptionId);
              
              // Afficher le message de succès
              formMessage.className = 'mt-6 p-4 rounded-2xl text-center font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';
              formMessage.innerHTML = `
                <div class="flex items-center justify-center mb-2">
                  <i class="fa fa-check-circle text-2xl mr-3"></i>
                  <strong>Inscription envoyée avec succès !</strong>
                </div>
                <p>Nous vous contacterons bientôt par email ou téléphone pour confirmer votre réservation.</p>
                <p class="mt-2 text-sm opacity-75">Référence: #${Date.now().toString().slice(-6)}</p>
              `;
              formMessage.classList.remove('hidden');
              
              // Réinitialiser le formulaire
              form.reset();
              calculateTotal();
              
              // Faire défiler vers le message de succès
              formMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
              
            } catch (error) {
              console.error('Erreur lors de l\'inscription:', error);
              
              // Afficher le message d'erreur
              formMessage.className = 'mt-6 p-4 rounded-2xl text-center font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';
              formMessage.innerHTML = `
                <div class="flex items-center justify-center mb-2">
                  <i class="fa fa-exclamation-triangle text-2xl mr-3"></i>
                  <strong>Erreur lors de l'inscription</strong>
                </div>
                <p>Une erreur s'est produite. Veuillez réessayer ou nous contacter directement.</p>
                <p class="mt-2 text-sm opacity-75">Code d'erreur: ${error.code || 'UNKNOWN'}</p>
              `;
              formMessage.classList.remove('hidden');
            } finally {
              // Réactiver le bouton
              submitButton.disabled = false;
              buttonText.textContent = '{{ .submit_button.label }}';
            }
          });
          
          // Validation en temps réel
          const inputs = form.querySelectorAll('input[required]');
          inputs.forEach(input => {
            input.addEventListener('blur', function() {
              validateField(this);
            });
            
            input.addEventListener('input', function() {
              if (this.classList.contains('error')) {
                validateField(this);
              }
            });
          });
          
          function validateField(field) {
            const isValid = field.checkValidity();
            
            if (isValid) {
              field.classList.remove('error', 'border-red-500');
              field.classList.add('border-green-500');
            } else {
              field.classList.add('error', 'border-red-500');
              field.classList.remove('border-green-500');
            }
          }
        });
        
        // Formatage automatique du téléphone
        document.addEventListener('DOMContentLoaded', function() {
          const phoneInput = document.getElementById('telephone');
          if (phoneInput) {
            phoneInput.addEventListener('input', function(e) {
              let value = e.target.value.replace(/\D/g, '');
              if (value.length >= 10) {
                value = value.substring(0, 10);
                value = value.replace(/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/, '$1 $2 $3 $4 $5');
              }
              e.target.value = value;
            });
          }
        });
      </script>
    {{ end }}
  {{ end }}
  <!-- /JavaScript pour le formulaire -->
{{ end }}
